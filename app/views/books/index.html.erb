<%= render partial: '/navigation' %>

<div class="body">
  <div class="container">

    <p id="notice"></p>
    <% if @book.errors.any? %>
      <div id="error_explanation">
        <h3><%= pluralize(@book.errors.count, "error") %> prohibited this obj from being saved:</h3>
        <ul>
          <% @book.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>

    <% end %>

    <div class="row">

      <div class="col-xs-3">
        <%= render partial: '/sideProfile' %>
      </div>

      <div class="col-xs-9">
        <h2>Books</h2>

        <table class="table table-hover table-inverse">
          <thead>
          <tr>
            <th></th>
            <th>Title</th>
            <th>Opinion</th>
            <th colspan="3"></th>
          </tr>
          </thead>

          <tbody>
          <% @books.each do |book| %>
            <% @users.each do |user|%>
              <% if user[:id] == book[:user_id] %>
                <tr>
                  <td>
                    <% if user[:profile_image_id].nil? %>
                      <%= link_to user_path(user[:id]) do %>
                        <%= image_tag 'no_image.jpg', size: '40x40',class: 'attachment user profile_image fallback' %>
                      <% end %>
                    <% else %>
                      <%= link_to user_path(user[:id]) do %>
                        <%= image_tag attachment_url(user, :profile_image, :fill, 50, 50, format: "jpg"),class: 'attachment user profile_image fallback'%>
                      <% end %>
                    <% end %>
                  </td>
                  <td>
                    <%= link_to book.title, book_path(book.id) %>
                  </td>
                  <td>
                    <%= book.body %>
                  </td>

                </tr>

              <% end %>

            <% end %>
          <% end %>

          </tbody>

        </table>
      </div>
    </div>
  </div>
</div>

<%= render partial: '/footer' %>